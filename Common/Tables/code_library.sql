/*

		REFACTOR: 
			[script_id] to [resource_id]
					I've ALREADY specified @ResourceID in dbo.load_library_code... 


*/

USE [admindb];
GO

IF OBJECT_ID(N'dbo.[code_library]', N'U') IS NULL BEGIN
	CREATE TABLE dbo.[code_library] (
		[script_id] int IDENTITY(1,1) NOT NULL, 
		[library_key] sysname NOT NULL, 
		[file_hash] varchar(64) NOT NULL, 
		[file_path] sysname NOT NULL, 
		[output_encoding] sysname NOT NULL, 
		[code] varbinary(MAX) NOT NULL, 
		CONSTRAINT PK_code_library PRIMARY KEY CLUSTERED ([script_id])
	);

	CREATE NONCLUSTERED INDEX IX_code_library_library_key ON dbo.[code_library] ([library_key]);
END;
GO

IF OBJECT_ID(N'dbo.[code_view]', N'V') IS NULL BEGIN
	EXEC('CREATE VIEW [dbo].[code_view] AS SELECT [code] FROM dbo.[code_library];');
END;

EXEC('TRUNCATE TABLE dbo.[code_library];');

DECLARE @fmtFile varchar(MAX) = N'{version}
1
1       SQLBINARY           0       0       ""   1     code         ""' + CHAR(13) + CHAR(10);

INSERT INTO [dbo].[code_library] ([library_key], [file_hash], [file_path], [output_encoding], [code])
VALUES (N'BCP_FMT_FILE', '', N'C:\Perflogs\lib\code.fmt', N'ANSI', CAST(@fmtFile AS varbinary(MAX)));

DECLARE @code varbinary(MAX) = 0x0300070070C600000B6700006400000064000000000000000100000001000000000000000000000001000000000000000000803F0300000000000000000000000F000080FFFFFFFFFFFFFFFF01000000000000000000000000000000FFFFFFFFFFFFFF7F000000000000000080808000FF000000000000000100000000000000000000000100000000000000010000000100000000000000000000000600000000000000020000000100000001000000640000000100000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000009001905F0100085365676F6520554900003D0000003D000000980000004C0000004C000000980000007A000000FEFFFFFF00000000FF000000010000000000000000000000170000005C0050006100670069006E0067002000460069006C00650028002A0029005C00250020005500730061006700650000FF00000100000000000000000000001C0000005C0050006100670069006E0067002000460069006C00650028002A0029005C00250020005500730061006700650020005000650061006B00FFD70000010000000000000003000000230000005C0050006800790073006900630061006C004400690073006B0028002A0029005C004100760067002E0020004400690073006B0020007300650063002F00520065006100640080800000010000000000000003000000240000005C0050006800790073006900630061006C004400690073006B0028002A0029005C004100760067002E0020004400690073006B0020007300650063002F0057007200690074006500FF0000000100000001000000000000001C0000005C00500072006F0063006500730073006F00720028005F0054006F00740061006C0029005C0025002000430031002000540069006D00650000FF0000010000000100000000000000230000005C00500072006F0063006500730073006F00720028005F0054006F00740061006C0029005C0025002000500072006F0063006500730073006F0072002000540069006D0065000000FF000100000001000000FFFFFFFF2E0000005C00530051004C005300650072007600650072003A0042007500660066006500720020004D0061006E0061006700650072005C00500061006700650020006C00690066006500200065007800700065006300740061006E0063007900FFFF00000100000001000000FEFFFFFF2D0000005C00530051004C005300650072007600650072003A0042007500660066006500720020004D0061006E0061006700650072005C005200650061006400610068006500610064002000700061006700650073002F00730065006300DA70A6000100000001000000000000002F0000005C00530051004C005300650072007600650072003A004C006100740063006800650073005C00410076006500720061006700650020004C006100740063006800200057006100690074002000540069006D006500200028006D007300290000BFFF000100000001000000000000002B0000005C00530051004C005300650072007600650072003A004C006100740063006800650073005C00530075007000650072004C0061007400630068002000440065006D006F00740069006F006E0073002F00730065006300FF00FF000100000001000000000000002C0000005C00530051004C005300650072007600650072003A004C006100740063006800650073005C00530075007000650072004C0061007400630068002000500072006F006D006F00740069006F006E0073002F00730065006300800080000100000001000000FEFFFFFF2D0000005C00530051004C005300650072007600650072003A004C006100740063006800650073005C0054006F00740061006C0020004C006100740063006800200057006100690074002000540069006D006500200028006D0073002900FFD700000100000001000000000000002F0000005C00530051004C005300650072007600650072003A004C006F0063006B00730028005F0054006F00740061006C0029005C004100760065007200610067006500200057006100690074002000540069006D006500200028006D007300290000FFFF000100000001000000FEFFFFFF2A0000005C00530051004C005300650072007600650072003A004C006F0063006B00730028005F0054006F00740061006C0029005C004C006F0063006B002000520065007100750065007300740073002F00730065006300000080000100000001000000FFFFFFFF380000005C00530051004C005300650072007600650072003A004C006F0063006B00730028005F0054006F00740061006C0029005C004C006F0063006B002000540069006D0065006F0075007400730020002800740069006D0065006F007500740020003E002000300029002F00730065006300F5DEB3000100000001000000FFFFFFFF270000005C00530051004C005300650072007600650072003A004C006F0063006B00730028005F0054006F00740061006C0029005C004C006F0063006B002000570061006900740073002F0073006500630000800000010000000100000000000000300000005C00530051004C005300650072007600650072003A004C006F0063006B00730028005F0054006F00740061006C0029005C004E0075006D006200650072002000\
6F006600200044006500610064006C006F0063006B0073002F0073006500630066CDAA000100000001000000FCFFFFFF370000005C00530051004C005300650072007600650072003A004D0065006D006F007200790020004D0061006E0061006700650072005C004700720061006E00740065006400200057006F0072006B007300700061006300650020004D0065006D006F0072007900200028004B0042002900B8860B000100000001000000FCFFFFFF370000005C00530051004C005300650072007600650072003A004D0065006D006F007200790020004D0061006E0061006700650072005C004D006100780069006D0075006D00200057006F0072006B007300700061006300650020004D0065006D006F0072007900200028004B004200290080800000010000000100000000000000330000005C00530051004C005300650072007600650072003A004D0065006D006F007200790020004D0061006E0061006700650072005C004D0065006D006F007200790020004700720061006E007400730020004F00750074007300740061006E00640069006E006700FF0000000100000002000000FCFFFFFF330000005C00530051004C005300650072007600650072003A004D0065006D006F007200790020004D0061006E0061006700650072005C00540061007200670065007400200053006500720076006500720020004D0065006D006F0072007900200028004B004200290000FF00000100000002000000FCFFFFFF320000005C00530051004C005300650072007600650072003A004D0065006D006F007200790020004D0061006E0061006700650072005C0054006F00740061006C00200053006500720076006500720020004D0065006D006F0072007900200028004B00420029000000FF000100000002000000000000002C0000005C00530051004C005300650072007600650072003A00530051004C00200053007400610074006900730074006900630073005C00420061007400630068002000520065007100750065007300740073002F00730065006300FFFF00000100000002000000000000002C0000005C00530051004C005300650072007600650072003A00530051004C00200053007400610074006900730074006900630073005C00530051004C00200041007400740065006E00740069006F006E0020007200610074006500DA70A6000100000002000000000000002E0000005C00530051004C005300650072007600650072003A00530051004C00200053007400610074006900730074006900630073005C00530051004C00200043006F006D00700069006C006100740069006F006E0073002F0073006500630000BFFF00010000000200000000000000310000005C00530051004C005300650072007600650072003A00530051004C00200053007400610074006900730074006900630073005C00530051004C002000520065002D0043006F006D00700069006C006100740069006F006E0073002F007300650063003D0000003D000000980000004C000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
0000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;
INSERT INTO [dbo].[code_library] ([library_key], [file_hash], [file_path], [output_encoding], [code])
VALUES (N'MSSQLSERVER_Perfmon', '6D015C0C5097CAC53A680887D03274703B8830D45913D7142A1CF608B413A88E', N'C:\Perflogs\lib\sql.perfmoncfg', N'BINARY', @code);


SET @code = 0xEFBBBF66696C74657220546573742D466F724973546561506F74207B0D0A0957726974652D486F7374202249276D2061206C6974746C6520746561706F74223B2023200D0A7D0D0A0D0A2320534947202320426567696E207369676E617475726520626C6F636B0D0A23204D4949716C41594A4B6F5A496876634E415163436F494971685443434B6F454341514578447A414E42676C67686B67425A514D45416745464144423542676F720D0A23204267454541594933416745456F4773776154413042676F724267454541594933416745654D43594341774541414151514838773759466C4C434536334A4E4C470D0A23204B58377A5551494241414942414149424141494241414942414441784D413047435743475341466C41775143415155414243417532355275684E584D6347456F0D0A23202F6A426D42456566306C32613469413263744A684E69684A376A4974557143434A513477676757444D49494461364144416745434167354635727344677A50440D0A232068575649357639465554414E42676B71686B694739773042415177464144424D4D534177486759445651514C4578644862473969595778546157647549464A760D0A232062335167513045674C5342534E6A45544D4245474131554543684D4B52327876596D467355326C6E626A45544D4245474131554541784D4B52327876596D46730D0A232055326C6E626A4165467730784E4445794D5441774D4441774D4442614677307A4E4445794D5441774D4441774D4442614D4577784944416542674E56424173540D0A23204630647362324A6862464E705A323467556D39766443424451534174494649324D524D77455159445651514B457770486247396959577854615764754D524D770D0A23204551594456515144457770486247396959577854615764754D494943496A414E42676B71686B6947397730424151454641414F43416738414D49494343674B430D0A2320416745416C51666F6338706D2B657755796E733839773049386252464379794374456A4736317338726F4F34515A497A464B5276662B6B717A4D6177694776460D0A2320746F6E5278724C2F464D3552464348735374306257736257682B354E4F6855473757526D43354B41796B54656335524F3836654A6630393459776A49456C42740D0A2320516D597654626C354B453153476F6F61674C635A6751352B784971385A45776848454E6F317A3038697357795A7457516D7263784273572B346D3079427159650D0A23202B626E7271714F3476373643593144513842694A332B5150656658716F683871306E4175652B65386B377474552B4A4966497751427A6A2F5A724A33595837670D0A2320366F77387172536B39764F56536849486266324D736F6E50304B426864386859644C4455497A72335854724B6F74756443643564524332513859484E56354C360D0A23206672785142474D3033327554474C35724E724935354B776B4E7266773737596345316554747436792B4F4B4674334F697544577152664C676E5461686231534B0D0A232038584A57626936497856464352425755377150464F4A6162546B35614330667A426A5A4A647A43386354666C7075776843485838356D455750336656325A47580D0A23206841707331414A4E644D4155376630352B34507958685368424C414C366637756A2B4675433749497332466D43577178426A706C6C6C6E413844583979646F6F0D0A23206A526F526833434243716961645232654F6F5946414A3762674E596C2B6477466E69645A54485935572B72357061485967772F522F39387745666D467A7A4E490D0A2320396370745A425173656C685030307349536357565A42706A446E6B3939624F4D796C69746E454A466557344F68786C63564C466C74722B4D6D397754365131760D0A2320754337635A32374A697847316842534B41426C7767336D526C3548554769652F4E78347942396755597A776F544B38434177454141614E6A4D474577446759440D0A2320565230504151482F42415144416745474D41384741315564457745422F7751464D414D4241663877485159445652304F42425945464B357342614F54452B4B690D0A2320352B4C58484E624838482F495A314F674D42384741315564497751594D426141464B357342614F54452B4B69352B4C58484E624838482F495A314F674D4130470D0A23204353714753496233445145424441554141344943415143444A65336F3066325655733265774153676B576E6D584E4345337479746F6B2F6F52336A575A5A69700D0A232057366738683377436974467574785A7A356C2F41564A6A56644C37427A6549526B61306A4744336434584A456C725356587342376A706C34466B4D54566C657A0D0A23206F724D377458666351484B736F2B75624E54367843434768353852444E336B797672586E6E43784D76454D706D59347730367768344F4D642B7467484D335A550D0A232041434971755530674C6E426F327556542F494E63303533792F30514D5247627930754F395267416162514B364A56324E6F54465233565247484533626D5A62760D0A232047687745584B595637336A6765663564327A3671544658396D685770622B476D2B3939774D4F6E44376B4A4737634B5442596E3666574E3750394278675877410D0A2320364A6975446E67307779583772777166494776644F784F50456F7A6951527049656E4F6764326E48746C782F677367652F6C67624B43756F624B3165626341460D0A2320306E75333634442B4A54662B4170746F72454A64772B37317A4E7A77554858534E6D6D63356E7345333234476162626543676C495759667265785267656D53710D0A2320615550766B63644D37426A64624F39544C59795A34563779636A3750564D69395A2B796B443078462F394F354D434D485449385176346157325A6C61744A6C580D0A2320484B544D7578574A55376F7342512F6B784A345A7352673031557964757533334836386B6C51523471414F37376F486C326C3938693071686B48516C70374D2B0D0A23205338677356723348794F3834346C795338486E336E495336644331684153422B667448795477645A5834737451314C72526779553466566D52336C33315652620D0A23204836306B4E387446576B366752456A49324C435A785257454366625753556E415A626A6D476E46756F4B6A7867756846506D7A574174634B5A344D4657736D6B0D0A232045444343426545776767504A6F414D434151494345486E446156474B412B63583431664C4A34465550766B774451594A4B6F5A496876634E4151454C425141770D0A2320657A454C4D416B474131554542684D4356564D78446A414D42674E564241674D4256526C6547467A4D5241774467594456515148444164496233567A644739750D0A23204D524577447759445651514B444168545530776751323979634445334D445547413155454177777555314E4D4C6D4E7662534246566942446232526C49464E700D0A23205A323570626D6367535735305A584A745A5752705958526C49454E4249464A54515342534D7A4165467730794E4445794D546B774E544D7A4D444661467730790D0A23204E7A41334D6A49784F4441334E445A614D4948744D517377435159445651514745774A56557A45544D424547413155454341774B5632467A61476C755A3352760D0A2320626A45514D413447413155454277774855334276613246755A54456E4D435547413155454367776554335A6C636B466A61476C6C646D567949464279623252310D0A2320593352706232357A4C43424D54454D754D5251774567594456515146457773324D444D674D444D784944457A4D6A456E4D435547413155454177776554335A6C0D0A2320636B466A61476C6C646D56794946427962325231593352706232357A4C43424D54454D754D523077477759445651515044425251636D6C325958526C494539790D0A23205A3246756158706864476C76626A45624D426B474379734741515142676A6338416745434441705859584E6F6157356E644739754D524D774551594C4B7759420D0A2320424147434E7A774341514D54416C56544D485977454159484B6F5A497A6A3043415159464B34454541434944596741455270506149637648596675715736474F0D0A2320354641336874494773514E3030576C7371666A4E676D5856424F784939415A6455796C642B613437665242635477475033736B6F7378776353543352367068790D0A232047756B344C4537666E4B464A4D5864584D716E2B2B4E4F6F4E6165314D6932464F6B6B66416C4F3177474563396C47426F3449426D6A4343415A5977444159440D0A2320565230544151482F424149774144416642674E5648534D45474441576742513276556E2F4D537A72723270412F706E41467532362F456A64587A4239426767720D0A23204267454642516342415152784D473877537759494B775942425155484D414B4750326830644841364C79396A5A584A304C6E4E7A6243356A6232307655314E4D0D0A2320593239744C564E31596B4E424C5556574C554E765A475654615764756157356E4C564A54515330304D446B324C56497A4C6D4E6C636A416742676772426745460D0A232042516377415959556148523063446F764C32396A6333427A4C6E4E7A6243356A62323077554159445652306742456B77527A41484267566E67517742417A41380D0A2320426777724267454541594B704D414544417749774C444171426767724267454642516343415259656148523063484D364C7939336433637563334E734C6D4E760D0A2320625339795A58427663326C3062334A354D424D47413155644A51514D4D416F47434373474151554642774D444D464147413155644877524A4D456377526142440D0A23206F45474750326830644841364C79396A636D787A4C6E4E7A6243356A6232307655314E4D593239744C564E31596B4E424C5556574C554E765A475654615764750D0A23206157356E4C564A54515330304D446B324C56497A4C6D4E796244416442674E5648513445466751557A5873423151744B63504C7637652F59466E444C597271360D0A23206544307744675944565230504151482F42415144416765414D413047435371475349623344514542437755414134494341514232332B39665874307A4A7072560D0A23204D69504E4C55343332484F396E5733343830726970702F666C56514E344F5A366835336E4E69504F53483034347738386F45566438397634724F444C487651300D0A2320674F764366364262417231335A616C53785A6C7841446B763547797838367337696C7431724C5373594C6572536F36595670665844334641667A50447442764F0D0A232043395945715864565A3836414E4A51426533475233755A7A335937715968716767347334436D36727A346C5239666E79786E71347047417535755A304F6774570D0A2320394A424157635273646A337A517156597A732B664C65514F466D665A504C436161363779692F756F7A4A47666F424365567933547A314A6F38524D6F4D384B550D0A23206664453153437A5534736766446B5973746C4E7959575A7034674A4F3478384E794C73795A524C677664746A4678745875576543586B6A48487566533051704C0D0A2320432F5869536E74346C46416451517036586779346F327A5076463053647547504D726D65556E4C425344712B5A476564666C4D47414C78596575747273454A390D0A2320556C6D4C2B7A596663664468585A374A654A3435724C4D36316138655433472F756D5237552F575438494973584D494475504B372F705A456D31787177497A430D0A23205632767738756470652F787052464D5946354355385867486332614F79366B4F4348555847676B36574459734A795844637A2B6C35723243685077544156535A0D0A23204535316F6C70324E4B724C643735446C5A45502F343034306879576F384E616C79684A7A49446C444F59486F354838386F5433643646675137674D32436A62420D0A232047352B774B54316A686255326B6669374A754E71415A4E766439764F72495A336F474E502B374B2B78655534614B455766792B7A752B3551374F4C3169476D360D0A23202F335035466A73776E4653664879614B59716A32774843674878726E4E6A434342657377676750546F414D4341514943434661324B63303076486A324D4130470D0A2320435371475349623344514542437755414D4947434D517377435159445651514745774A56557A454F4D41774741315545434177465647563459584D784544414F0D0A232042674E564241634D4230687664584E30623234784744415742674E5642416F4D44314E545443424462334A7762334A6864476C76626A45334D445547413155450D0A23204177777555314E4D4C6D4E7662534246566942536232393049454E6C636E52705A6D6C6A595852706232346751585630614739796158523549464A54515342530D0A23204D6A4165467730784E7A41314D7A45784F4445304D7A6461467730304D6A41314D7A41784F4445304D7A64614D4947434D517377435159445651514745774A560D0A2320557A454F4D41774741315545434177465647563459584D784544414F42674E564241634D4230687664584E30623234784744415742674E5642416F4D44314E540D0A23205443424462334A7762334A6864476C76626A45334D445547413155454177777555314E4D4C6D4E7662534246566942536232393049454E6C636E52705A6D6C6A0D0A2320595852706232346751585630614739796158523549464A54515342534D6A4343416949774451594A4B6F5A496876634E415145424251414467674950414443430D0A232041676F4367674942414938325A554468316B33413137547052747072366A4E487A557A356658322B76533039384E74343459616C32626F4A56326A74567A36670D0A232030416842672B636F5153516634334956304145612B31357749374C4C6E7A6E6A7A38564F78704A744A735A37753750614A35304B68756D424E77582B384846780D0A2320374D4D6336574F69467853643778746E3034565641674C5753636E4D57754778393238796E386E554F346842714A7939793676626258734A48364A4D637044610D0A23204B776A387A7A78557A6D6350714D39646C686B4C784F4E79363633526652306E37354C72454C3962367A75767A34446477644B574246743666715370504468320D0A232070474B4F6F446C65366E66505851425A6A325973506765696F77556D45576D58366F57334435594C53386841345643364C6F724C39772B614975642F6D6A63540D0A23207A664A4E453273683063444D49764B6852765A45615A7A4B5954554841472F57595167523672713439756D7A594F564E756579664647624A56316A627A5964700D0A23202B49714745674E4876325954647178336654516B6859504E313671636B4271664953782F654C646B754E6A6F707652347331584C684E4979784869756F3439680D0A2320336334495536337369507756354A6F4E357038616438354D6A376755465431696E4959344267426D4575525A646C705477414B596F684172614552376A6E6E4F0D0A23204D307032716C75424668753169746A51414874655972514A316F5A6A447159466C556D364B4975496B374930484E696B56573633484E44656D565537492F51690D0A232034506B705A6962734946423332306F4C6A37376C416D427751563755726C41354968516D79374937633352565277643567546D6F4D424E453551534B727059540D0A23204A554950755650456D2F7A4E35427A655050717231675A4B4832656D6D44416333537A6233426956563262472F31794C5676563341674D424141476A597A42680D0A23204D41384741315564457745422F7751464D414D4241663877487759445652306A42426777466F41552B574337314F50564E506134395161414A61647A32305A700D0A2320714A3477485159445652304F4242594546506C677539546A31545432755055476743576E63397447616169654D41344741315564447745422F775145417749420D0A2320686A414E42676B71686B6947397730424151734641414F434167454156724F4F797771645359362F704D535275325958425647596466766C554378366E7645550D0A23202B717654696A372F6B536D5059347659744B6C554151322B6B3459762B55707478313731562F6E4B56527753766B63504E7358666172666264634A484A582B350D0A23203857503461433156424E48796A62436B7A377738586839343536576749484377424D573339334B6E3369494E76544D6C526F786B6B69626A5069356A6C7471620D0A23206A44333447416E5841387839686F4C6779675148555644582F354C56444F2F6168702B5A312B753372326A694F536155756D693376345054366E706E50574A6E0D0A23207269586C63756A69354F797545765A4C4B7A796636624241387A6855732F3233614D6A61786F3952504C4C376B647763353575643462634E636F2F69704D53700D0A232065506E72464B7A47517758435A546B6F47414C4467724B644262356C375A5A665A5851382B776B314C6E7563452F3062443133486259453656672F4D4F2B47760D0A2320416938697245624B526A796748457A57524C52654C6C77565A676E684A696E2B786C4A687572467A2F384D4D6E4F56736170512F464D70414670574538316D700D0A23207246394D595A4E743054764D6F70554D49715A6E5A30517575646E53696B477A5A6774612B33306A7066496173502F656D344F554C74452F33354B336B6138460D0A23204F3258486F4779787A574953773541623479584F4E4C787664336178454D50334252724131713930596B675864354A706B474563337057416446535047427A440D0A2320387750517636524464595A5447486F4B4C676B634E702B522F594B4B496B7652446C416C336373444442664A67774149546A564E696F767438414B555A6978450D0A2320663875564A35595872516B77724C5A784632364C462F5963436451744F35696C63644E5545396C67382F564C5A6B2F3638653467456F32307246657852574F680D0A2320724861707776737767675A5A4D49494551614144416745434167304237427953514E37394C6B4264664564304D413047435371475349623344514542444155410D0A23204D4577784944416542674E56424173544630647362324A6862464E705A323467556D39766443424451534174494649324D524D77455159445651514B457770480D0A23206247396959577854615764754D524D774551594456515144457770486247396959577854615764754D423458445445344D4459794D4441774D4441774D466F580D0A232044544D304D5449784D4441774D4441774D466F77577A454C4D416B474131554542684D43516B55784754415842674E5642416F544545647362324A6862464E700D0A23205A323467626E5974633245784D54417642674E5642414D544B45647362324A6862464E705A32346756476C745A584E30595731776157356E49454E42494330670D0A2320553068424D7A673049433067527A5177676749694D4130474353714753496233445145424151554141344943447741776767494B416F494341514477417549770D0A2320492F7267472B4761644C4F7664594E6671556453783245365933773549336C746450777835485153475A62367A6964695736344869696675563650454E65327A0D0A23204E4D657377777A7267475A743053684B77537937755844796371364D39356C61585861757630536F6645456B6A6F2B3678552F2F4E6B477270793339654535440D0A2320695036544752665A376A485076496F37626D7245695044756C2F62633878696753356B63446F656E4A7547497961446C6D654B65394A784D50313162374C62760D0A2320306D585052517455506246555577654C6D573634564A6D4B714447534F2F4A366666774F574E2B42617547776242356C67697255496365552F6B4B574F2F454C0D0A23207358392F5270674F687A31365A65765256716B7576667459506257462B6C4F5A5456743037584A4C6F6732434E786B4D304B7671577348764439575A75542F300D0A2320547A58786E412F544E784E5332535530375A62762B476671434C36505358722F6B4C485539796B56312F6B4E58646148517835307848416F74494237765371620D0A2320753454684471787644626D31396D31572F6F6F644354346B446D636D782F797944614355734C4B557A48766D5A2F366D574C4C553245455377565839627048460D0A23207537464D434575653145494762787359315462715A4B374F2F66554635754A6D30413446496179784551596A4765543742545245366769756E556C6E455975430D0A2320356131616871646D2F544D444164365A4A666C7862756D6358514A4D59447A50416F38422F584C756B76476E45743543456B33737153626C64774B73446C634D0D0A2320436446686E6961492F4D69795464746B384557667573452F564B505964674B566247714E79694A633967774534796E3653374163307A6430684E6B645A7173300D0A232063343865665878656C74593947624358366F78516B57327656345A2B4544636461786F5533774944415141426F3449424B5443434153557744675944565230500D0A23204151482F42415144416747474D42494741315564457745422F7751494D4159424166384341514177485159445652304F42425945464F6F57786D6E6E343874580D0A232052546B7A7050424176744444765757574D42384741315564497751594D426141464B357342614F54452B4B69352B4C58484E624838482F495A314F674D4434470D0A2320434373474151554642774542424449774D444175426767724267454642516377415959696148523063446F764C32396A633341794C6D647362324A6862484E700D0A23205A323475593239744C334A76623352794E6A413242674E56485238454C7A41744D4375674B61416E6869566F644852774F69387659334A734C6D647362324A680D0A232062484E705A323475593239744C334A7662335174636A597559334A734D45634741315564494152414D4434775041594556523067414441304D444947434373470D0A2320415155464277494246695A6F64485277637A6F764C3364336479356E624739695957787A615764754C6D4E76625339795A58427663326C3062334A354C7A414E0D0A232042676B71686B6947397730424151774641414F4341674541662B4B493256646E4B304A666761634A433772457579675956745A4D76397362423344472B77734A0D0A23207251413659444D664F63595761786C4153535549487553623939616B445938656C764B476F68666551623950346279727A65374149347A476866354C465354350D0A23204745547348384B6B724E43797A2B7A43566D556476582F32336F4C497435396830375647534A6958416D64364670564B32324C47304C4D437A445249525658640D0A2320374F6C4B6E3134553758495163585A7730672B57382B6F3356355352474B2F636A5A6B3447566A437161462B6F6D34564A7571302B583871352B64495A476B760D0A232030707168637662334A457430576E3179686A577A416C636669357A387536784D33767265553079442F524B78746B6C56543357647247394B79433571756371490D0A23207778497754724949633539656F64615A7A756C39533559737A425A72474D336B5754654743537A69526461797A573643646158616A52363357792B494C6A31390D0A232038664B524D4157637A6E74386F4D577372314547384248484854444655565A673648795650534C6A31516F6B55796558675070496953637365654938355A73650D0A232034367145676F6B2B7745723149663569454F30644D507A327A4F70494A33794C64554A2F6138767A70577556487752594E41714A37594A51354E4637714D6E6D0D0A2320766B69714B31585A6A62636C494134625561445559367144366D78795955724A2B6B5045786C66466E625938734975777552777837373376464E6755514777670D0A232048634974364176476A57324D746E48745569482B507661666E7A6B6172717A534C336F6773665373716833694C5253642B705A71486359387976505A484C39540D0A2320546152485758795678454E422B5358694C42422B67666B4E6C4B64393872554A39646867636B42516C5344555130532B2B7143563579425A746E6A47704771710D0A23204970737767675A764D494945563641444167454341684142584D434B3835753055334F5769636361677030794D413047435371475349623344514542444155410D0A23204D467378437A414A42674E5642415954416B4A464D526B77467759445651514B45784248624739695957785461576475494735324C584E684D5445774C7759440D0A23205651514445796848624739695957785461576475494652706257567A6447467463476C755A7942445153417449464E4951544D344E434174494563304D4234580D0A2320445449314D4455784E5441344D7A41774D466F5844544D304D5449784D4441774D4441774D466F77616A454C4D416B474131554542684D43516B5578475441580D0A232042674E5642416F4D4545647362324A6862464E705A323467626E5974633245785144412B42674E5642414D4D4E30647362324A6862484E705A32346756464E420D0A232049475A766369424E557942426458526F5A57353061574E765A475567515752325957356A5A5751674C5342484E434174494449774D6A5577676747694D4130470D0A232043537147534962334451454241515541413449426A7741776767474B416F4942675143505478735A6450714C72702F4738734D4876595964344B756E6973557A0D0A232051612B466A6F4B324B665A48366C51315542375776475A563158386A4A797771615A4B4E665168484C466278624134724F752F6E614D53537158352F544F584A0D0A2320642B464C4A2B6C452B39513868794639464B4A333533573374504C432B4F374B65416F416238307674307547525873344E6F514E473564594D5A4842696636490D0A232052554464685A747566465478574A723563524957627352433234554177624B355451496F6B6734336875555065586A32714B5A756B7561734B513574555443720D0A232055686D595233494670486B79567064752B63644263455077344B394E353368696D4153715248656A346E7A2F3267477348364F764C4649704A617759625377690D0A232056386D364463704856785433706C78446A396E435538387754566769707A7364612B7049357676686874343249472F6E3465314255592B6671706836454A4D370D0A2320627333435352366874416D44736E3465734537694D64516D2F2B6D6B566F77324F6E427A6B38474C673267754545454E4157676838334F6C57424754767A77470D0A23206D4B61592B4649396D6144727176476E45756A38517A6A6259334B71333844346A73466772516A694C416549387A3032676C74495457716174594471616E596B0D0A232072536E79386B30356F45485048455A53415841322B5369585646504B66557735786F73434177454141614F43415A3477676747614D41344741315564447745420D0A23202F775145417749486744415742674E5648535542416638454444414B4267677242674546425163444344416442674E564851344546675155317A6A37754D66370D0A2320504A777577457054635A744B4E6F382B72624D77544159445652306742455577517A424242676B724267454541614179415234774E44417942676772426745460D0A2320425163434152596D6148523063484D364C793933643363755A327876596D467363326C6E6269356A62323076636D567762334E706447397965533877444159440D0A2320565230544151482F42414977414443426B4159494B775942425155484151454567594D77675941774F5159494B775942425155484D4147474C576830644841360D0A23204C79397659334E774C6D647362324A6862484E705A323475593239744C324E684C32647A64484E685932467A6147457A4F44526E4E44424442676772426745460D0A232042516377416F59336148523063446F764C334E6C593356795A53356E624739695957787A615764754C6D4E766253396A59574E6C636E51765A334E306332466A0D0A232059584E6F59544D344E4763304C6D4E796444416642674E5648534D45474441576742547146735A70352B504C563055354D365477514C37517737316C6C6A42420D0A232042674E56485238454F6A41344D4461674E4B4179686A426F644852774F69387659334A734C6D647362324A6862484E705A323475593239744C324E684C32647A0D0A232064484E685932467A6147457A4F44526E4E43356A636D77774451594A4B6F5A496876634E4151454D42514144676749424141724B7768766730796A416262584D0D0A232038634E5943476A44686F67545A5474655333574A34536E366D326148396A3032335A306D6E714A747745414E4C7A78744947667A77626E58546254595A3767570D0A23206D3948756736534E45377A697477534933706F4A42317063754F456C33444F7A54517932742F50354E62335077502B674C796B2B2B4963367A596D49333453660D0A2320694B596545472B55724D7464473442695835566F7576555972505A6F2B6F3532514136305A4632342B326359676F6F422B434A6F6C545571586143666A4964690D0A232044466D31476E316F56692F467254442B307146365752703459587A346E462F7268646E682F50587035343667494B356D4B6375386B742F6B6E36396647386D4C0D0A23206A4D6950463356624A35416D47507745334738763568624C50515557485A4B706F6C4679796D3847444D6834635453376667304B425A7265614676656F2F62790D0A2320326F6762527776304A5A4761726E526367516C3545395551624A326F74616A374A364276686F467A347A644C31426B686B494663414E6C782F3369444C5736530D0A2320723978775A3265377A36584D55385456626664426F6431326F767A5336586F6F434F62306D61376B786C73654F37774C677564596F353059416A33515A5963740D0A232062375A7A4C55706C527A2B58644554784A633565596C6C49684256786F42466B753265392B3549434B4D6E4F53426F46426671586E424959556851326759474F0D0A2320316B456B4D754530534945363379486E5147767254724D4E632F7651665950504F41456B684E72542B76796D346459426C61614C44304F4F6C673452503031770D0A2320754656587A736644344A33443173414B594E46544147613849586F6E6A437276455A6E756E6566312B746A5277472B34584D77794C777259766E7534494178640D0A23206A364F575A35395734614E546A786B5842656945434D2F634D6B6A6E4D494947337A4343424D65674177494241674951516B7471553837485A6851634B6D4F780D0A2320705278424244414E42676B71686B6947397730424151734641444342676A454C4D416B474131554542684D4356564D78446A414D42674E564241674D4256526C0D0A23206547467A4D5241774467594456515148444164496233567A644739754D526777466759445651514B4441395455307767513239796347397959585270623234780D0A23204E7A413142674E5642414D4D4C6C4E545443356A6232306752565967556D3976644342445A584A3061575A7059324630615739754945463164476876636D6C300D0A23206553425355304567556A49774868634E4D546B774D7A49324D5463304E44497A5768634E4D7A51774D7A49794D5463304E44497A576A42374D517377435159440D0A23205651514745774A56557A454F4D41774741315545434177465647563459584D784544414F42674E564241634D4230687664584E30623234784554415042674E560D0A232042416F4D43464E545443424462334A774D5463774E515944565151444443355455307775593239744945565749454E765A47556755326C6E626D6C755A79424A0D0A2320626E526C636D316C5A476C686447556751304567556C4E424946497A4D494943496A414E42676B71686B6947397730424151454641414F43416738414D4949430D0A232043674B4341674541384B6F33397973686B53426E4F6A6D4F46655568756C6F544B6F315230484D39766134426A424E37316E37345A6D5074394873726B76472B0D0A2320593276337144646C646731384E4B64537364683438462F706E336436595436445A75786D7A72656B505830616C61386458582F466C556D67324F7139492B61550D0A232050356C754A555934784657594F447970394F577565647237645734414878412F735938432F304B756B767A3130316F4A4A564A6A694E3166394A456F466857720D0A23205643366338643767323949796153466E526D31585835764B3054642F70326B6E48713437616C3679786771675057416566486246484B4D435A584F454D5758740D0A23202F6C566F6D367768305A324566756F427A2B546E5330775958575342647A5A6F787750347973513239703853624E3145475176705948344A4B397561504462500D0A23206A7145634166643174665A766877734457732B593138736F554A656C6F664B6F49527A377355773136686862467364465841416765572B4930314276635066460D0A2320306B4D6646354A2B4D5A61705162704438726E526A635A6F6B754362696F445765645970582B6241675972797977354E4744594C6461704A4E75306A7A68664F0D0A232055596370304E674D6F714A6D2F39766E6B784F4C664A544A6131474E5574593737346F4E354C332B4F4B466161466E59422B65314E6243514F4478624C5349510D0A23206C77633773724979594748474F425673734C7131666F5035504C497148722B747A56696E6A32383762446666726F67735239385248616A58464C526C72302F320D0A23206F6B6D795958414B2F746C4F46336858586F6B6C3073516553744F65632B6F5561436B43496C48397A7851454C763865383553556E584E51724B71704B304E780D0A2320495935324D70596F45466B72374438673653376D302B4E6D4A5245346E476C4436744D6B70502B694A656F49446968596E4F6B434177454141614F43415655770D0A2320676746524D42494741315564457745422F7751494D4159424166384341514177487759445652306A42426777466F41552B574337314F50564E506134395161410D0A23204A61647A32305A70714A3477664159494B7759424251554841514545634442754D456F474343734741515546427A4143686A356F644852774F693876643364330D0A23204C6E4E7A6243356A62323076636D567762334E7064473979655339545530786A62323074556D397664454E424C5556574C564A54515330304D446B324C5649790D0A23204C6D4E7964444167426767724267454642516377415959556148523063446F764C32396A6333427A4C6E4E7A6243356A62323077455159445652306742416F770D0A23204344414742675256485341414D424D47413155644A51514D4D416F47434373474151554642774D444D455547413155644877512B4D4477774F7141346F4461470D0A23204E476830644841364C79396A636D787A4C6E4E7A6243356A6232307655314E4D593239744C564A76623352445153314656693153553045744E4441354E6931530D0A23204D69356A636D7777485159445652304F4242594546446139536638784C4F7576616B442B6D63415737627238534E31664D41344741315564447745422F7751450D0A232041774942686A414E42676B71686B6947397730424151734641414F4341674541636F2F36675569436B654A6767795662653438766C412B44574D36494A50715A0D0A2320516B3474546A654A2B4A2B784871353051486E35337376332F79776C45464B59514939554F503964305371705775613341727649662B3471302F392F7A4459380D0A232056536C4458545A4A6C695A64634F66794B77566E5230795A57426B4939724847543244532F44692B4171776C3059674E70537A6833644E395638397177786C670D0A2320306D3271585874453646706267397649477A594B66677231436C4932654F4B612B784E557A4A7A4A52373969546A57765075473644386D5437745567743561330D0A232055485A534E5871646F54736D5A4463667A7277446538526867564B4A7A48762B576755615236376B4573714F564F4E616E37444269764C3558305A6F75612F480D0A2320325436453053736C456A673975356F4236742F4D5A716932785239716B3065777A676153684B3144673271474F56784D34674A4C65484F7553796A6D705068680D0A23206159444D2F7A546F7343396B416B6B4E6A5334666665756868675550375635774E4F555941674472593735314A6D326E484A42584236365A70593433307166440D0A23205747796C394F6453496A576E5737747536306A626D6E4C65716C706953516D656B437353443867363236396F6335335A34336E4B6D506C6F4865726D574336700D0A232047477A4E6D5471617A535A77524F5A6D6D4A776C48686C7178396A7A352F2B6D4E586637395832376A494C48623331554D7276716D5173353643425246532B4A0D0A2320347972687853447A656E684F5061385859704A556A53654D6B44666334796E6F51704F322B44737243356C51754F51304270676A3775726674565337727476780D0A2320367431792B555874736470444F34443862327A66334A4674754B58553733584E5A55786B4C466E664579344347307636424A5041757A6364483749673030387A0D0A232072786168484D437171496778676754634D49494532414942415443426A7A42374D517377435159445651514745774A56557A454F4D41774741315545434177460D0A23205647563459584D784544414F42674E564241634D4230687664584E30623234784554415042674E5642416F4D43464E545443424462334A774D5463774E5159440D0A2320565151444443355455307775593239744945565749454E765A47556755326C6E626D6C755A79424A626E526C636D316C5A476C686447556751304567556C4E420D0A23204946497A4168423577326C526967506E462B4E5879796542564437354D413047435743475341466C41775143415155416F4577774751594A4B6F5A496876634E0D0A232041516B444D5177474369734741515142676A6343415151774C77594A4B6F5A496876634E41516B454D5349454945626753334F3736575251557434666E5A33310D0A232070444B6758366A7165456D31494166555A314357347356664D41734742797147534D3439416745464141526E4D4755434D5143486B497A65316D6B38394677760D0A2320456A486832494C6236773773416675756C6F61533348766F4F417A6E426F63754E76472F51592F6379383746474A52766D4938434D464561397A52712F5933750D0A232036436974552B6B4838586D6D586B2F336736626B55574D446E65435852437A4973436F676E4B553658765A6779776B444D563641744B47434132777767674E6F0D0A232042676B71686B6947397730424351597867674E5A4D49494456514942415442764D467378437A414A42674E5642415954416B4A464D526B77467759445651514B0D0A232045784248624739695957785461576475494735324C584E684D5445774C7759445651514445796848624739695957785461576475494652706257567A644746740D0A232063476C755A7942445153417449464E4951544D344E4341744945633041684142584D434B3835753055334F5769636361677030794D417347435743475341466C0D0A23204177514341614343415430774741594A4B6F5A496876634E41516B444D5173474353714753496233445145484154416342676B71686B694739773042435155780D0A23204478634E4D6A55774F4449344D5451784E545135576A417242676B71686B69473977304243545178486A41634D417347435743475341466C417751434161454E0D0A232042676B71686B694739773042415173464144417642676B71686B694739773042435151784967516764523168686A61684235456B62613032455755356458314D0D0A23202F5630394D756F47366E304276624A5277746B776761514743797147534962334451454A4541494D4D5947554D4947524D49474F4D49474C42425277583971430D0A232056444C7A395963723762386A724B416B75714E625654427A4D462B6B585442624D517377435159445651514745774A435254455A4D4263474131554543684D510D0A232052327876596D467355326C6E626942756469317A595445784D4338474131554541784D6F52327876596D467355326C6E626942556157316C63335268625842700D0A2320626D6367513045674C5342545345457A4F4451674C5342484E41495141567A4169764F6274464E7A6C6F6E48476F4B644D6A414E42676B71686B6947397730420D0A2320415173464141534341594259765735483731496F4B754A61756436574D6A7237506E44502B6F4E2B565572774268786C71474D434D50744F4552576E58326E6E0D0A23207136463543415543726A3163625A325774416168334D6E583965336D4552564464584E672F6E7A4E4D5A4D46586B3530366C62777832306C3656384A5A4A45650D0A23207A654B417463667A3542554C33536A3850774F5039665838585A6463562B76616351694835747648346B616F616B5978756E6455375238674A7A5259484139630D0A23204D756A396246356C72385974386B62626F445043786D4A494B7752396A595468355A4F5A5A346D4F535A44424761694164494B30463951485662785437654C310D0A23204A6B6855342B56533733564C6275437A31305643304C647135316C4E4144796B6C734E49464F4C4B656D4D57423073436A4572506F31697078337538516870420D0A23205736512B416A466A764861627163644D38424E533156527770766B685A74727638376C7339556473794E78777179324E7665722F43614C4B6B6F4847494E65760D0A23203164744C43703873514F6B5452416F50794F5635626E584B397736412B33553761507648676433362F6757474E2B542F623263577374644A4841552B65746E6C0D0A232037486C4C56692B563879424E2F307655502B46707832716E556147734B70374F6771364B2F724348646F416641466F4B524D484F78772B7461366E7746684D2F0D0A2320774A587A4F794F384D64593D0D0A2320534947202320456E64207369676E617475726520626C6F636B0D0A;
INSERT INTO [dbo].[code_library] ([library_key], [file_hash], [file_path], [output_encoding], [code])
VALUES (N'TeaPotTest', '40230C86DC69CAFFEC3FB2C7822A8C854DA89BF8067D3F0429B09E0EDC1EC487', N'C:\Perflogs\lib\teapottest.ps1', N'BINARY', @code);


-- other binaries to add:
--	IF @Key = UPPER(N'MetricStore-ManageCollectors') BEGIN 
--		SELECT @content = N'file-contents here ... where each tick has been search-replaced by a double-tick and so on.';
--		-- and, insanely enough... I'm going to need to SIGN the code ... and then escape the ticks out of it. 
--		-- but... i think it should work. 
--	END;

--	IF @Key = UPPER(N'MetricStore-EtlCollectorData') BEGIN 
--		SELECT @content = N'this would be the code for ... ETL-ing stuff. i.e., all the funcs in question - so that I could pass in
--basically... 
--		-DataCollectorSetName
--		-TargetTable
--		-LSET? 
--		-CET? 
--		-OtherOptions
--	via some sort of command that''d a) first @dotSource this file (the crap I''m typing right now) then b) ... call into whatever func was
--necessary to ETL ... with c) the switches populated above and d) all in -encodedCommand happiness. ';